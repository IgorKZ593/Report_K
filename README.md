# Report_K
Automated Report Generation in Python A structured project for financial report generation using Excel files, reference dictionaries (ISIN, tickers), and modular processing logic. Developed with versioning, reproducibility, and clarity in mind.

Данный модуль решает задачи в рамках проекта подготовки аналитических брокерских отчётов для клиентов компании N1 Broker.

Он обеспечивает:
- Проверку корректности вводимых дат (начальной и конечной);
- Проверку на соответствие выходным и национальным праздникам США;
- Ограничение по дате начала (не ранее 01.01.2022);
- Подсказку ближайших допустимых дат в случае ошибки;
- Возможность досрочного выхода из скрипта пользователем (по нажатию Esc);
- Сохранение валидированных дат в формате JSON в указанную папку проекта.

Модуль написан при участии Cursor по следующему запросу:


Для данного варианта commit 

README — insert_date.py
========================

Описание
--------
Скрипт `insert_date.py` предназначен для интерактивного ввода даты начала и окончания отчётного периода с проверкой на корректность, выходные и праздничные дни в США. Подходит для использования в проектах, где требуется формировать отчёт с учётом рабочих дней, включая аналитику для клиентов компании N1 Broker.

Основной функционал
-------------------
✅ Поддержка цветного вывода в консоль с помощью библиотеки `rich`  
✅ Проверка введённой даты на:
- выходные (суббота и воскресенье)
- праздники в США (через библиотеку `holidays`)
- ввод текущей или будущей даты (не допускается)
- минимальный допустимый период (с 01.01.2022)
✅ Подсказка ближайших допустимых дат, если введена неподходящая  
✅ Возможность выхода по нажатию клавиши `Esc`  
✅ Сохранение выбранного диапазона в файл `Data_work/report_dates.json`

Установка зависимостей
----------------------
Для работы требуется установить библиотеки:

```
pip install rich holidays keyboard
```

Логика работы
-------------
1. При запуске отображается приветствие.
2. Пользователь вводит дату начала отчета.
3. Скрипт проверяет:
   - Корректность формата (дд/мм/гггг)
   - Не является ли дата сегодняшним днем или будущей
   - Не является ли она выходным или праздником
   - Не нарушает ли минимальный период или порядок следования дат
4. В случае недопустимой даты — выводятся цветные уведомления и подсказки.
5. Аналогично вводится дата окончания отчета.
6. После успешного ввода обеих дат — сохраняется файл JSON и отображается подтверждение периода.

Формат вывода в JSON
--------------------
```json
{
  "start_date": "01.07.2025",
  "end_date": "15.07.2025"
}
```

Пример запуска
--------------
```
python insert_date.py
```

Структура проекта
-----------------
- `insert_date.py` — основной скрипт
- `Data_work/report_dates.json` — автоматически создаваемый файл с датами отчета

Дополнительно
-------------
- Поддержка автоматической установки `rich` при первом запуске, если модуль отсутствует.
- Используется библиотека `keyboard` для отслеживания клавиши Esc.
- Все важные сообщения форматированы цветом: ошибки — красным, подсказки — желтым, подтверждения — зелёным/синим.

Автор: Игорь Кирьянов  
Компания: N1 Broker  
Дата: Июль 2025


